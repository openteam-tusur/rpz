<%= content_for :title, "Группа #{@group.number} #{@faculty.abbr}" %>

<div><%= Group.human_attribute_name(:number) %>: <%= resource %></div>
<div><%= Group.human_attribute_name(:course) %>: <%= "#{resource.course} курс" %></div>
<div><%= Group.human_attribute_name(:year_forming) %>: <%= resource.year_forming %></div>
<div><%= Group.human_attribute_name(:budget_students_count) %>: <%= resource.budget_students_count %></div>
<div><%= Group.human_attribute_name(:payment_students_count) %>: <%= resource.payment_students_count %></div>
<div><%= Group.human_attribute_name(:speciality_code) %>: <%= resource.speciality_code %></div>
<div><%= Group.human_attribute_name(:speciality_title) %>: <%= resource.speciality_title %></div>
<div><%= Group.human_attribute_name(:subspeciality_title) %>: <%= resource.subspeciality_title %></div>

<%= link_to t('edit'), edit_resource_path %>
<%= link_to t('remove'), resource_path, :method => :delete, :confirm => t('are_you_sure') %>

<% [resource.semesters.autumn, resource.semesters.spring].flatten.each do |semester| %>
  <div class='<%= semester.semester.title %>'>
    <h2><%= semester.semester.title_text %></h2>
    <table class="plan">
      <tr class="thead">
        <th>Номер</th>
        <th rowspan="2">Вид<br />обучения</th>
        <th rowspan="2" class="week">Всего<br />часов</th>
        <th rowspan="2" class="week">Итог</th>
        <th colspan="<%= semester.weeks_count %>" class="center">Распределение занятий</th>
        <th rowspan="2">Преподаватель</th>
        <th rowspan="2">Кафедра</th>
        <th rowspan="2">Форма<br />учёта</th>
      </tr>
      <tr class="thead">
        <th>Цикл</th>
        <% semester.weeks.each do |week| %>
          <th class="center <%= semester.css_class_for(week) %>"><%= week.number %></th>
        <% end %>
      </tr>
      <% semester.educations.each do |education| %>
        <tr class="tbody">
          <td rowspan='<%= education.trainings.count + 1 %>'>
            <p><%= education.cycle_code %></p>
          </td>
          <th colspan="<%= semester.weeks_count + 4 %>">
            <%= education.discipline.title %>
          </th>
          <td rowspan='<%= education.trainings.count + 1 %>'>
            <%= education.chair.abbr %>
          </td>
          <td rowspan='<%= education.trainings.count + 1 %>'>
            <%= raw(education.checks.collect(&:title).join("<br />")) %>
          </td>
        </tr>
        <% education.trainings.each_with_index do |training, index| %>
          <tr class="tbody">
            <td><%= training.title %></td>
            <td class="right"><%= training.planned_loading %></td>
            <td class="right">&nbsp;</td>
            <% semester.weeks.each do |week| %>
              <td class="right <%= semester.css_class_for(week) %>">
                &nbsp;
              </td>
            <% end %>
            <td>
              &nbsp;
            </td>
          </tr>
        <% end %>
      <% end %>
      <tr class="tfoot">
        <th colspan="2">
          Итого:
        </th>
        <th class="right"><%= semester.summ_planned_loading %></th>
        <th class="right">&nbsp;</th>
        <% semester.weeks.each do |week| %>
          <th class="right">&nbsp;</th>
        <% end %>
        <th colspan="3"></th>
      </tr>
    </table>
  </div>
<% end %>
